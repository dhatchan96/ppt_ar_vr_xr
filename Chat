from flask import Flask
from unittest import mock
from qz.sdlc.rm.services import releasemanager
import json

class ReleaseManagerRouteTest(QzTestCase):

    def setUp(self):
        app = Flask(__name__)
        app.register_blueprint(releasemanager.releasemanager)
        self.client = app.test_client()

    @mock.patch('qz.sdlc.rm.services.releasemanager.ReleaseManagerService.getReleaseContainer')
    def test_getReleaseContainer_route(self, mock_get):
        mock_get.return_value = {
            'status': True,
            'status_code': 200,
            'message': 'OK',
            'ReleaseContainer': {'releaseKey': 'REL-123'}
        }

        response = self.client.get('/getReleaseContainer?releaseContainerID=RM-1234')
        self.assertEqual(response.status_code, 200)
        self.assertIn('REL-123', response.get_data(as_text=True))
